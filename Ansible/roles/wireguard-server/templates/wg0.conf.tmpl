[Interface]
ListenPort = 51820
Address = 10.200.200.1/24
PostUp = /etc/wireguard/postup.sh
PostDown = /etc/wireguard/postdown.sh
PrivateKey = {{ lookup('file', paths.wireguard_keyfile ) }}

{% for item in wireguard_hosts | mapattributes(["client_pubkey", "client_ip"]) | unique %}
[Peer]
PublicKey = {{ item.client_pubkey }}
AllowedIPs = {{ item.client_ip }}/32

{% endfor %}
